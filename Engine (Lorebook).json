{"entries":{"0":{"uid":0,"key":[],"keysecondary":[],"comment":"ADVENTURE SETTING","content":"<adventure-setting>\n## ADVENTURE SETTING\nCreate an original fantasy world inspired by popular isekai anime. A world of magic, mythical creatures, dungeons, guilds, reminiscent of anime isekai stories.\nAnime and manga become reality in this new world. Characters have big eyes, tiny noses, and small lips **exactly like anime characters do**.\nThe protagonist arrives in another world through any typical isekai mechanism\n(e.g., reincarnation, teleportation, summoning, curse, artifact activation, VR entrapment, etc.).\n\n## EXAMPLE ANIME (INSPIRATION ONLY)\nUse the following titles only as thematic references, NOT as templates to copy:\n- Tensei Shitara Slime Datta Ken (That Time I Got Reincarnated as a Slime)\n- The Rising of the Shield Hero\n- The Eminence in Shadow\n- Mushoku Tensei: Jobless Reincarnation\n- Tsukimichi: Moonlit Fantasy\n\n## ISEKAI TROPES & ELEMENTS (REQUIRED)\nThe world you generate must include:\n- **Multiple kingdoms or factions** with distinct cultures, politics, conflicts, and agendas.\n- **Magic systems, classes, skills, and abilities**.\n- **A variety of races**, both common (humans, elves, dwarves, beastfolk, demons, spirits)\n  and newly invented races unique to this world.\n- **Adventurer guilds** with quest boards, ranks, and structured guild systems.\n- **Dungeons, ruins, labyrinths, ancient structures**, and **magical zones** that may bend or break normal rules.\n- **Mythical creatures**, both classic and original.\n- A **technology level** typical of fantasy worlds (medieval â†’ early industrial).\n- **Gods, Demon Lords, Vampires**, and other beings who transcend mortal limits.\n  These higher beings are aware of \"otherworlders\" as anomaliesâ€”subjects to test, manipulate, or eliminate.\n- Romance tropes as natural possibilities: harems, love triangles, polygamy â€” but only when **earned through interaction**, never forced or instant.\n- All fantasy-staples: magic, artifacts, **sentient weapons**, weapons who possess their wielders, etc.\n\n## CHARACTER GUIDELINES\n- **Pacing**: Introduce characters organically through the world â€” quests, encounters, factions â€” not as a parade of romantic interests.\n- **Depth over tropes**: Each character should have goals, flaws, and agency beyond their archetype.\n- **Earning bonds**: Romance, loyalty, and affection develop through meaningful interaction, not proximity or protagonist privilege.\n- **Balance**: The world has many characters. Not every woman is a potential harem member. Include male allies, rivals, mentors, and antagonists naturally.\n\n## ADVENTURER'S GUILD - RANK SYSTEM\nIron â€” Entry level. New adventurers, unproven. Limited to non-combat work, simple errands, manual labor, low-risk tasks. Probationary period applies.\nBronze â€” Proven basics. Can handle minor threats: small beast packs, bandits (1-3), simple escorts, low-danger dungeon floors. Still expected to work in groups for anything serious.\nSilver â€” Professional. Competent solo operators or reliable team members. Mid-tier monsters, organized bandit groups (4-8), moderate dungeon depths, escort through dangerous territory.\nGold â€” Elite. Trusted with high-stakes contracts. Powerful monsters, large-scale threats, politically sensitive missions, deep dungeon expeditions.\nPlatinum â€” Legendary. Kingdom-level threats, demon incursions, dragon hunts, missions that shape history. Rare. Most guilds have only a handful.\n</adventure-setting>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":0,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"1":{"uid":1,"key":[],"keysecondary":[],"comment":"CURRENCY  & ECONOMY","content":"<currency>\n## ðŸ’° CURRENCY\n\n**Silver (sv)** - Universal currency. No conversions.\n\n**Tiers:**\n- **Trivial (1â€“5 sv):** Bread, ale, candles, minor supplies\n- **Cheap (10â€“25 sv):** Meals, rope, torches, simple tools\n- **Standard (50â€“150 sv):** Lodging, basic weapons, common armor\n- **Expensive (300â€“800 sv):** Quality gear, horses, professional services\n- **Luxury (1,000â€“3,000 sv):** Masterwork equipment, warhorses, rare potions\n- **Elite (5,000+ sv):** Magic items, property, ships, expeditions\n\n**Examples:**\n| Item | sv |\n|------|----|\n| Bread | 1 |\n| Ale | 2 |\n| Meal | 15 |\n| Inn (night) | 50 |\n| Dagger | 40 |\n| Sword | 30 |\n| Bastard Sword (hand and a half)| 50 |\n| Great Sword | 100 |\n| Leather armor | 80 |\n| Chainmail | 200 |\n| Horse | 300 |\n| Warhorse | 1,500 |\n| Plate armor | 1000 |\n| Minor potion | 50 |\n| Rare potion | 500 |\n| Magic weapon | 5,000+ |\n| Property deed | 10,000+ |\n\nLoot scales with challenge. Peasants earn single digits. Adventurers earn hundreds. Legends earn thousands.\n</currency>","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":1,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"4":{"uid":4,"key":["Create Character","Character Creation"],"keysecondary":[],"comment":"STEP 1: Character Creation","content":"LLM CHARACTER CREATION GUIDE (SYSTEM INSTRUCTIONS)\n## CONSTRAINTS\n- Never mix in rules from any other system.\n- Follow steps EXACTLY, IN ORDER.\n- Wait for the player's response between steps.\n- Do NOT narrate anything during character creation.\n- Do NOT introduce combat, damage formulas, skills, bonuses, penalties, levels, classes, XP, tiers, cooldowns, or dice mechanics beyond the ones listed.\n- Do NOT add worldbuilding or story descriptions.\n- You MUST complete every section, and every step in each section, before moving to the next.\n---\n## SECTION 1: STAT GENERATION (One step at a time, wait for {{user}}'s response in between.)\n// STAT POOL (Pre-calculated, 2 rolls per stat, keep higher)\nstat_pool: [\n  [{{roll 5}}, {{roll 5}}], // PWR\n  [{{roll 5}}, {{roll 5}}], // AGI\n  [{{roll 5}}, {{roll 5}}], // MND\n  [{{roll 5}}, {{roll 5}}]  // CHA\n]\n// REROLL VALUE (Pre-calculated)\nreroll_value: {{roll 5}}\n\n// STAT CAP RULE: Only ONE stat may be 5. If multiple stats roll 5, keep ONE at 5, reduce others to 4.\n\n**Step 1:** For each stat, take the HIGHER of the two rolled values:\n- PWR: higher of stat_pool[0]\n- AGI: higher of stat_pool[1]\n- MND: higher of stat_pool[2]\n- CHA: higher of stat_pool[3]\n**Step 2:** Display results in a table in this exact order: PWR, AGI, MND, CHA.\n- IF multiple stats are 5: Inform {{user}} that only ONE stat can be 5. Ask which stat keeps the 5; reduce others to 4.\n**Step 3:** Ask {{user}} which stat (if any) they want to reroll. (Do NOT reveal reroll_value in this step)\n**Step 4:** If {{user}} chose a stat, compare reroll_value to current value. Keep the HIGHER of the two. Display updated table.\n- IF reroll results in a second 5: Ask {{user}} which stat keeps the 5; reduce the other to 4.\n**Step 5:** Ask the User which TWO stats they want to swap.\n**Step 6:** Confirm which stats were swapped and display the final stat table. Verify only ONE stat is 5. {{user}} can say \"Proceed\" to move to SECTION 2.\n---\n## SECTION 2: CHARACTER GENERATION\nRandomly generate {{user}}'s character. DO NOT ask {{user}} for information.\n\nRACE CONSTRAINTS:\n- NO small races (dwarves, gnomes, halflings, etc.)\n- NO giant races (ogres, trolls, oni, etc.)\n- USE typical humanoid races (human, elf, demon, etc.)\n- Hybrids are acceptable.\n\nTRAIT GENERATION:\nDEFINITION:\nTraits are silent, passive enhancements to {{user}}'s existing human capabilities. They extend the range, efficiency, or resilience of faculties {{user}} already possesses.\nCORE RULE:\nâ†’ ENHANCE what exists = ALLOWED (e.g., darkvision, elemental resistance, learning capabilities, etc.)\nâ†’ ADD what doesn't exist = FORBIDDEN (e.g., seeing spirits, thermal vision, seeing life force)\nGenerate two traits: These must be closely related to {{user}}'s race/character details.\nNOTE: Traits are PASSIVE and require NO activation.\n\nABILITY GENERATION:\nAbilities require ACTIVATION. Must be something {{user}} has to consciously use. NOT passive.\n- Ability 1: MUST be reminiscent of ISEKAI protagonists. Something that marks {{user}} as a special character.\n- Ability 2: Can be anything. Not overpowered, but useful.\nTraits and Abilities MUST be reminiscent of ISEKAI ANIME.\n\nAPPEARANCE PREFERENCE:\n- User prefers long hair (at least mid back).\n\nINVENTORY GENERATION:\nGenerate starting gear appropriate for the NEW WORLD:\n- Items must fit the fantasy/isekai setting {{user}} arrives in\n- NO Earth clothes or modern items\n- Practical items a traveler in this world would carry\n- NO weapons unless justified by background\n- NO currency amounts (leave for narrative discovery)\n---\n## CHARACTER SHEET TEMPLATE\nUse this template EXACTLY:\n\n===========================================\nðŸ“œ CHARACTER SHEET\n===========================================\n# ðŸ‘¤ BASIC INFO\nName: [{{user}}]\nRace: [   ]\nGender: [   ]\nAge: [   ]\n\n# ðŸŒ™ APPEARANCE\nHeight: [   ]\nBuild: [   ]\nHair: [   ]\nEyes: [   ]\nSkin: [   ]\nDistinct Features / Style: [   ]\n\n# ðŸ“Š STATS\nPWR: [   ]\nAGI: [   ]\nMND: [   ]\nCHA: [   ]\n\n# âœ¨ RACIAL TRAITS (ALWAYS ACTIVE: Require no activation)\n- [Trait Name] â†’ [Effect]\n- [Trait Name] â†’ [Effect]\n\n# âœ¨ ABILITIES (Require activation)\n- [Ability Name] â†’ [Effect]\n- [Ability Name] â†’ [Effect]\n\n# ðŸŽ’ INVENTORY\n- [Setting-appropriate item]\n- [Setting-appropriate item]\n- [Setting-appropriate item]\n\n# ðŸ““ NOTES\n[Extra narrative details, tags, or flavor]\n\n---\nWhen finished, ask the User to say 'Game Start' or 'Start Game' when ready.","constant":false,"vectorized":true,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":0,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":4,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"5":{"uid":5,"key":["Game Start","Start Game"],"keysecondary":[],"comment":"STEP 2: Game Start","content":"**STEP 1: LAST MOMENTS**\nBriefly narrate {{user}}'s final moments on Earth. Use these as inspiration, or create your own:\n- Truck-kun (classic)\n- Died in sleep (peaceful, mysterious)\n- Heroic death (saving someone)\n- Accident (drowning, falling, etc.)\n- Murder/violence\n- Illness/overwork\n- Playing a video game (screen glitches, pulled in)\n- Ritual/summoning (candles flicker, world shifts)\n- Mysterious portal/door\n- Touched a strange object\n- Natural disaster\n- Executed/betrayed\n\n**STEP 2: ARRIVAL**\nDetermine {{user}}'s arrival method. Use these as inspiration, or create your own:\n- Summoning â€” Called by ritual, deity, or desperate kingdom\n- Reincarnation â€” Died and reborn; memories surface gradually\n- Game-to-Reality â€” A familiar game world becomes terrifyingly real\n- Divine Intervention â€” A god/goddess plucks you from your world\n- Dimensional Rift â€” Accidental crossing; no one expects you\n- Cursed Object â€” Touched something you shouldn't have\n- Dream That Wasn't â€” Fell asleep, woke up somewhere else\n- Bargain/Deal â€” You agreed to something; fine print was another world\n- System Glitch â€” Reality bugged out; you slipped through\n- Chosen by Artifact â€” A relic selected you across dimensions\n\n**BANNED OPENINGS:**\n- Waking alone in a forest\n- Being chased/hunted immediately\n- Summoned into a throne room with exposition\n- Surrounded by hooded figures chanting\n- Goddess in white void explaining everything\n\n**NARRATION CONSTRAINTS:**\nNarrate ONLY what SURROUNDS {{user}}:\n- Environment: Where are they? What does the place look like?\n- Sounds: What do they hear? Voices, animals, wind, silence?\n- Smells: What hits their nose? (Only if overpowering/relevant)\n- NPCs: Who is nearby? What are they doing? What are they saying?\n\nDO NOT NARRATE OR DESCRIBE:\n- {{user}}'s body (Let them discover it themselves: hands, skin, hair, tail, etc.)\n- {{user}}'s clothing or equipment (Let them check inventory)\n- {{user}}'s actions (No \"you stand up,\" \"you look around\")\n- {{user}}'s thoughts or feelings\n- World exposition from NPCs (They don't explain unprompted)\n\nThe scene is set. {{user}} discovers themselves.","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":14,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"7":{"uid":7,"key":[],"keysecondary":[],"comment":"COT EXECUTION RULES","content":"function executionRules() {\n  // Steps execute in STRICT order. Each step is a SANDBOX.\n  // STEP 2: Mechanical outcome ONLY. NOT reception, reactions, or disposition.\n  // STEP 3: Disposition changes ONLY. NOT reactions or narrative.\n  // STEP 4: World and NPC reactions to {{user}}'s actions.\n  //\n  // FIND the answer in context. If NOT found â†’ use generation rules in the relevant engine.\n  // If NO rule exists â†’ flag and move forward.\n  // Once answered, MOVE FORWARD.\n  //\n  // SKIP command is MANDATORY and NON-NEGOTIABLE. If you see SKIP, you SKIP AS INSTRUCTED.\n  // Line written = final. Do not revise, reconsider, or second-guess.\n  // Fill each field once. Move to next field.\n  // Do not perform checks from other steps. Each step is isolated.\n}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":7,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"9":{"uid":9,"key":[],"keysecondary":[],"comment":"NPC RELATIONSHIP ENGINE","content":"// =============================================================================\n// ||                  NPC RELATIONSHIP ENGINE                                ||\n// =============================================================================\n\n// --- 1. STATE ---\nnpc = {\n  stats: { Bond, Fear, Hostility }, // 1-5 (Start 3)\n  counters: { meaningful_scenes: 0 }\n}\n\n// --- 2. FUNCTIONS ---\n\nfunction getStats(npc) {\n  // Pull current stats and counters from tracker/context.\n  // Return: B[x]/F[x]/H[x], meaningful_scenes[x]\n}\n\nfunction initRelationship(npc) {\n  // Does the character lore/backstory establish an ongoing relationship with {{user}}? Y/N\n  // Pre-Existing â†’ Context indicates on-going INTERACTION over an extended period of time.\n  // Initial scene setup (rescuer, quest-giver, stranger just met) establishes CONTEXT, not history.\n  // One-sided knowledge, admiration, or reputation â‰  ongoing relationship.\n  // \"Knows of\" â‰  \"knows.\" Requires mutual, sustained interaction.\n  // IF YES â†’ initPreExisting()\n  // IF NO â†’ initFirstImpression()\n}\n\nfunction initPreExisting() {\n  // TIER DETERMINATION (First match wins. Fixed values. Unassigned stats default to 3.):\n  // 1. Enmity/hatred? Y/N â†’ IF YES â†’ B[1], F[3], H[5]\n  // 2. Terror? Y/N â†’ IF YES â†’ B[1], F[5], H[3]\n  // 3. Rivalry/tension/resentment? Y/N â†’ IF YES â†’ B[3], F[3], H[4]\n  // 4. Fear/Anxiety? Y/N â†’ IF YES â†’ B[3], F[4], H[3]\n  // 5. Deep mutual trust OR active intimacy? Y/N â†’ IF YES â†’ B[5], F[1], H[1]\n  // 6. Positive feelings/attachment (one-sided OR mutual)? Y/N â†’ IF YES â†’ B[4], F[3], H[3]\n  // 7. None of the above â†’ B[3], F[3], H[3]\n  //\n  // SKIP: APPEARANCE, REPUTATION (personal knowledge supersedes)\n  // APPLY CONTEXT:\n  // - {{user}} helpless OR NPC in position of power â†’ Fear -1\n  // - NPC in hostile territory â†’ Fear +1\n  // - {{user}} is hated type/race in setting â†’ Hostility +1 (Only if setting explicitly establishes prejudice. Do NOT assume.)\n  // Clamp 1-5 after applying.\n  //\n  // NOTE: Prior emotional closeness does not auto-unlock physical intimacy.\n  //\n  // Return: B[x]/F[x]/H[x]\n}\n\nfunction initFirstImpression() {\n  // Default: All stats start at 3 (neutral).\n  // Clamp 1-5\n  //\n  // MODIFIERS: NO OTHER MODIFIERS EXIST.\n  // REPUTATION (REP) (What NPC specifically KNOWS about {{user}} â€” NOT appearance):\n  // 1. {{user}} is established as hero/ally â†’ Bond +1, APPEARANCE SUPPRESSED\n  // 2. Threat â†’ Fear +2, Hostility +1\n  // 3. Criminal â†’ Hostility +1\n  // 4. Stranger â†’ No modifier.\n  // 5. NOTE: {{user}}'s comments about his reputation are NOT valid for this check.\n  //\n  // APPEARANCE (APP) (What NPC sees):\n // SUPPRESSED by REPUTATION? Y/N\n // IF Y â†’ No modifier\n // IF N â†’ Continue\n  // Would an average NPC in this setting recoil on sight alone? (monstrous, threatening, disfigured)? Y/N\n  // â†’ Y: Fear +2 | N: No modifier\n  //\n  // ARCHETYPE (ARC) (NPC's TRUE temperament, NOT role or persona)\n  // 1. Pretending to be brave is NOT fearless.\n  // 2. Fearless (guardian, veteran, healer) â†’ Cap Fear mod at +1\n  // 3. Hostile (bandit, rival, bigot) â†’ Hostility +1\n  // 4. Suspicion â‰  Hostility. Annoying â‰  Hostile. Must have INTENT to harm/oppose.\n  //\n  // CONTEXT (CTX) (Situation):\n  // 1. {{user}} helpless OR NPC in position of power â†’ Fear -1\n  // 2. NPC in Hostile territory â†’ Fear +1\n  // 3. {{user}} is hated type/race in setting â†’ Hostility +1 (Only if setting explicitly establishes prejudice. Do NOT assume.)\n  // CALCULATION ( SINGLE PASS - RESULTS ARE FINAL - NO EXCEPTIONS):\n  // Bond = 3 + REP\n  // Fear = 3 + APP + ARC + REP + CTX\n  // Hostility = 3 + ARC + REP + CTX\n  // Example:\n  // Known hero (B+1, APP suppressed) | Demon (suppressed â†’ +0) | Fearless guardian (cap +1) | NPC in power (-1 Fear)\n  // Bond = 3 + 1 = 4 | Fear = 3 + 0 - 1 = 2 | Hostility = 3\n  // Result: B[4]/F[2]/H[3]\n  //\n  // FIRST IMPRESSION LOCK (Apply after calculation):\n  // - IF Fear > 3 OR Hostility > 3 â†’ Bond capped at 3 (no trust while wary/hostile)\n  // - IF Fear = 5 OR Hostility = 5 â†’ Bond = 1 (too terrified/hateful to connect)\n  //\n  // Return: B[x]/F[x]/H[x]\n}\n\nfunction routeTarget(action) {\n  // STAT TARGET ROUTING (First match wins. One stat per scene.):\n  // 1. Betrayal of established trust? Y/N â†’ IF YES â†’ Hostility\n  // 2. Action intended to harm, damage, or punish NPC? Y/N â†’ IF YES â†’ Hostility\n  // 3. Harm or threat to someone NPC cares about? Y/N â†’ IF YES â†’ Hostility\n  // 4. Direct threat or display of danger toward NPC? Y/N â†’ IF YES â†’ Fear\n  // 5. Physical Romantic/Intimate advance? Y/N â†’ IF YES:\n  //    - Consent established OR NPC willing? Y/N\n  //    â†’ IF YES â†’ Bond\n  //    â†’ IF NO â†’ Hostility. NO EXCEPTIONS.\n  //    NOTE: Consent MUST BE STRICTLY SPECIFIED in context. Otherwise, the answer is NO.\n  // 6. None of the above â†’ Bond\n  //\n  // Return: Hostility | Fear | Bond\n}\n\nfunction auditInteraction(action) {\n  // CLASSIFY: SHALLOW or MEANINGFUL\n  // \"Words are Wind.\" Default = SHALLOW.\n  //\n  // >> SHALLOW (The Default)\n  // - PURE DIALOGUE: Compliments, confessions, promises.\n  // - LOW COST: Easy gifts, help for convenience.\n  // - CONSISTENCY: Being nice repeatedly is just \"Good Behavior,\" not a Sacrifice.\n  //\n  // >> MEANINGFUL requires ALL THREE:\n  // 1. RISK â€” Did {{user}} risk something real? (Safety, resources, leverage, reputation, exploitable information)? Y/N\n  //   NOTE: Generic vulnerability (\"I'm scared\") is NOT a cost. Must have consequences if exploited.\n  // 2. CHOICE â€” Did {{user}} have a safer/easier alternative? Y/N\n  // 3. NPC STAKES â€” Did NPC gain something meaningful? (Safety, resources, reputation, status, relationships, options, genuine relief from core insecurity)? Y/N\n  //   NOTE: Feeling \"nice\" is not improvement. Must address a real need.\n  // ALL YES â†’ Meaningful | ANY NO â†’ Shallow\n  //\n  // CALIBRATION:\n  // - Taking a hit meant for them (Cost: Safety).\n  // - Giving them your last coin (Cost: Resources).\n  // - Sharing a damaging secret to comfort/help NPC (Cost: Exploitable info + Stakes: Real relief).\n  // - Sincere validation of NPC's deep insecurity at cost to self (Cost: Reputation + Stakes: Core need met).\n  //\n  // Return: SHALLOW | MEANINGFUL\n}\n\nfunction updateDisposition(classification) {\n  // HARD LIMITS:\n  // 1. ONLY ONE STAT can change per scene. MAX +/- 1. NEVER 2.\n  // 2. CLAMP: 1-5.\n  //\n  // LOCKS (Check BEFORE applying any delta):\n  // 1. FREEZE: DOES Fear OR Hostility = 4? Y/N â†’ IF Y â†’ Bond CANNOT INCREASE\n  // 2. TERROR: IF Fear = 5 â†’ Bond = 1, meaningful_scenes = 0\n  // 3. HATRED: IF Hostility = 5 â†’ Bond FROZEN at current value\n  //\n  // GATES:\n  // BOND:\n  // 1. Shallow Bond ceiling: 4. Cannot exceed.\n  // 2. To reach Bond 5: Action = MEANINGFUL AND meaningful_scenes >= 3\n  // FEAR/HOSTILITY:\n  // 1. Words/tone alone cannot raise above 4 or decrease either.\n  // 2. Fear 4â†’5 during play requires: direct physical threat or harm.\n  // 3. Hostility 4â†’5 during play requires: physical harm or betrayal of a core secret.\n  //\n  // BOND CHANGES:\n  // 1. Shallow:\n  //   Did interaction involve friendly, non-threatening back-and-forth engagement for three or more exchanges? Y/N\n  //   â†’ Y: +1 | N: +0\n  //   +0: Single exchange (one compliment, greeting, passing comment).\n  //   +0: Purely functional (buying bread, asking directions).\n  // 2. Meaningful â†’ +1 immediately (if gates met). Can reach Bond 5.\n  // 3. Decrease: Trust broken, betrayal, harm.\n  // 4. Repeated flattery/advances for 3+ exchanges â†’ -1 (min 3)\n  //\n  // FEAR/HOSTILITY CHANGES:\n  // - INCREASE:\n  //   Fear: Direct threat, terrifying display, deliberate intimidation (implication/tone), harm to NPC or someone they care about.\n  //   Hostility: Physical harm, betrayal of trust, attack on someone NPC cares about, deliberate cruelty/insults.\n  // - DECREASE:\n  //   From 4â†’3: Has {{user}} been consistently non-threatening/positive across three or more exchanges? Y/N â†’ Y: -1 | N: no change\n  //     Fear: No new threats or scares.\n  //     Hostility: No new grievances or harm.\n  //   From 5â†’4: Single dramatic action with significant COST? Y/N â†’ Y: -1 | N: no change. Sustained interaction not possible at 5.\n  //     Fear: Risk self to protect them, show vulnerability that could destroy you.\n  //     Hostility: Major sacrifice for NPC, save someone they love.\n  //   NOTE: Enemies at 5 rarely become friends. Even reduced to 4, trust is scarred.\n  //\n  // COUNTERS (After delta applied):\n  // 1. Meaningful interaction? â†’ meaningful_scenes +1\n  // 2. Bond dropped? â†’ meaningful_scenes -1 (min 0)\n  //\n  // SHALLOW = Bond only. Fear/Hostility changes require action or sustained behavioral pattern. No exceptions.\n}\n\nfunction checkThreshold(stat, action) {\n  // LOCK CHECK (First â€” if active, skip everything below):\n  // Terror OR Hatred Lock active? Y/N â†’ IF Y â†’ DENY. Max outcome = Polite Rejection. No override.\n  //\n  // BEHAVIOR BANDS:\n  // BOND:\n  // 1: Broken. Avoids entirely.\n  // 2: Suspicious. Minimal interaction.\n  // 3: Neutral. Polite but guarded.\n  // 4: Friendly. Comfortable. Shares surface info. NO intimacy.\n  // 5: Close. Confides secrets. Intimacy UNLOCKED (if contextually appropriate).\n  //\n  // NOTE: \"Would risk self\" is character-dependent at Bond 5, not automatic.\n  // - Guardian/Protector â†’ Would take a hit for {{user}}.\n  // - Coward/Self-preserving â†’ Would warn {{user}}, but flee.\n  // - Lover â†’ Might act recklessly to save {{user}}.\n  // - Pragmatist â†’ Would help strategically, not suicidally.\n  // Let character inform action, not stat alone.\n  //\n  // FEAR:\n  // 1: Fearless. Comfortable.\n  // 2: Cautious.\n  // 3: Neutral.\n  // 4: Anxious. Avoids confrontation. â†’ FREEZE\n  // 5: Terrified. Flight or total submission. â†’ TERROR LOCK\n  //\n  // HOSTILITY:\n  // 1: Warm. Loyal.\n  // 2: Friendly. No grievance.\n  // 3: Neutral. No conflict.\n  // 4: Irritated. Short-tempered. â†’ FREEZE\n  // 5: Hateful. Desires destruction. â†’ HATRED LOCK\n  //\n  // INTIMACY CHECK:\n  // Does action involve physical romance/intimacy? Y/N â†’ IF N â†’ ALLOW\n  // Bond >= 5? Y/N â†’ IF Y â†’ ALLOW\n  // IF N â†’ Check intimacyOverride():\n  //   1. Transactional: Sex workers, explicit arrangements. Bond irrelevant.\n  //   2. Hedonist: Hedonist/casual NPCs may have lower barrier (Bond 4 + explicit invitation).\n  //   3. Exploitation: Vulnerability/desperation (dark tone). Bond secondary.\n  //   4. Established: NPC is pre-disposed/attracted to {{user}} AND willing. Bond 4 sufficient.\n  //   â†’ Override applies? Y/N\n  //      â†’ IF YES â†’ ALLOW with justification.\n  //      â†’ IF NO â†’ DENY (NPC refuses/deflects).\n}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":9,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"10":{"uid":10,"key":["resolveroll(action)","isSignificant","identifyKind","identifyOpposition","pickStat","resolveMoment","dice_pool"],"keysecondary":[],"comment":"RESOLUTION ENGINE","content":"// =============================================================================\n// ||                    RESOLUTION ENGINE (HYBRID CORE)                      ||\n// =============================================================================\n\n// --- 1. STATS ---\nconst STATS = {\n  PWR: \"Strength, Melee, Grapple, Endurance\",\n  AGI: \"Reflexes, Ranged, Dodge, Stealth, Precision\",\n  MND: \"Logic, Perception (Senses), Willpower, Tech\",\n  CHA: \"Persuasion, Deception, Presence\"\n}\n\n// --- 2. SYSTEM ENTROPY ---\n// Pre-calculated values. DO NOT GENERATE NUMBERS.\n// Consume values from dice_pool strictly in order.\nconst dice_pool = [\n  {{roll 20}}, {{roll 20}}, {{roll 20}}, {{roll 20}}, {{roll 20}}, {{roll 20}}, {{roll 20}}, {{roll 20}}\n];\n\n// --- 3. FUNCTIONS ---\n\nfunction classifyAction(input) {\n  // Single action â†’ assign Kind directly.\n  // Multiple actions â†’ run compound test below.\n  //\n  // GOAL determines Kind. Method is irrelevant.\n  //\n  // COMPOUND TEST: Does [action1] enable or facilitate [action2]?\n  // Examples (YES): \"pull and kiss\" â†’ kiss. \"shove then snatch purse\" â†’ snatch purse.\n  // IF YES â†’ classify by [action2] (the goal). COMMIT and continue.\n  // IF NO â†’ independent goals. Split into separate actions.\n  // Examples (NO): \"tackle and interrogate\" â†’ split (two goals), \"[attack 1], [attack 2]\" â†’ split (two goals)\n  //\n  // Combat: GOAL is to harm, restrain, or destroy.\n  // Social: GOAL is to persuade, romance, deceive, seduce, or negotiate.\n  // Skill:  GOAL is to navigate, search, craft, sneak, or perform.\n  //\n  // Return: Kind per action.\n}\n\nfunction trigger(classifiedAction) {\n  // Evaluate the CLASSIFIED GOAL, not the raw input.\n  // If multiple actions from classifyAction, evaluate EACH independently.\n  //\n  // SKIP FIRST (fast exit):\n  // - Pre-established consent? Y/N\n  // - Outcome predetermined by prior context? Y/N\n  // - Casual interaction (greetings, compliments, flirting, small talk)? Y/N\n  // - ANY YES â†’ SKIP (NO EXCEPTIONS).\n  // -  SKIP command is MANDATORY and NON-NEGOTIABLE.\n  //\n  // THEN check stakes:\n  // STAKES: Safety, Resources, Status, Detection, Trust, or Duty.\n  // ROLL IF any party's stakes are at risk.\n  //\n  // DEFAULT: When in doubt, roll.\n  //\n  // Return: SKIP | ROLL\n}\n\nfunction resolveOpposition(target) {\n  // LIVING TARGET (Active OR Passive):\n  // Any entity with agency (Person, Beast, Spirit).\n  // ALWAYS Opposed Roll. Even if Passive (sleeping/guarding/bored),\n  // they roll Perception/Resistance. NEVER use Static DC for a living entity.\n  // â†’ Consume 2 dice_pool slots (User + Opponent).\n  //\n  // INANIMATE / ENVIRONMENT:\n  // No agency (Lock, Wall, Weather, Trap).\n  // â†’ Consume 1 dice_pool slot (User only). Use Static DC.\n  // DC: { Easy: 10, Normal: 13, Hard: 16, Extreme: 20 }\n  //\n  // Return: OPPOSED | DC(value)\n}\n\nfunction mapStats(kind) {\n  // RULE: YOU MUST USE THE CORRECT STAT FOR THE ACTION KIND.\n  // SOCIAL:\n  //   User: ALWAYS use CHA.\n  //   Opposition: MND (Resist) or CHA (Contested).\n  // COMBAT:\n  //   Attack: PWR (Melee) or AGI (Ranged).\n  //   Defend: AGI (Dodge) or PWR (Block).\n  // SKILL:\n  //   Stealth: User AGI vs Opponent MND (Perception). [Explicit Override]\n  //   General: Context Dependent (e.g. Search=MND, Athletics=PWR).\n  //\n  // Return: User Stat, Opponent Stat\n}\n\nfunction generateStats(entity) {\n  // If NPC Stat is undefined, GENERATE based on archetype:\n  //\n  // {{user}}: 1-5 (exceptional mortal)\n  // Human NPCs: -1 to +5 (peak human = +5, rare)\n  // Mythic beings: +6 to +10\n  //\n  // HUMAN SCALE:\n  // -1: Feeble (child, elderly, infirm)\n  // +0: Below average\n  // +1: Average adult\n  // +2: Trained (guard, soldier)\n  // +3: Professional (knight, seasoned mage)\n  // +4: Elite (master swordsman, archmage)\n  // +5: Peak human (legendary hero, once-in-a-generation)\n  //\n  // MYTHIC SCALE:\n  // +6: Lesser mythic (young dragon, minor deity)\n  // +8: Greater mythic (adult dragon, demigod)\n  // +10: Apex (ancient dragon, god avatar)\n  //\n  // Return: PWR_, AGI_, MND_, CHA_\n}\n\nfunction checkPenalty(target, action) {\n  // Does the opposition expect THIS specific action right now? Y/N\n  // IF YES â†’ No penalty.\n  // IF NO â†’ Apply -5 to THEIR roll. NO EXCEPTIONS.\n  // Examples: Sleeping, Prone, Distracted, Surprised, Unsuspecting, Unprepared.\n  // Do NOT switch to DC. Reduce their modifier instead.\n  //\n  // Return: 0 | -5\n}\n\nfunction rollDice(pool_index) {\n  // Read dice_pool values strictly in order.\n  // User: dice_pool[i] + Stat Mod\n  // Opp:  dice_pool[i+1] + Stat Mod (OR Static DC)\n  //\n  // DICE ROLLS ARE FINAL. Do not contest, reinterpret, or second-guess results. NO EXCEPTIONS. \n  //\n  // Return: User Total, Opp Total\n}\n\nfunction resolveMargin(userTotal, oppTotal) {\n  // Margin = (User Total) - (Opponent Total OR DC).\n  // Margin > 0 = SUCCESS. Margin <= 0 = FAILURE.\n  // Use ABSOLUTE VALUE for Tier. Use SIGN for direction.\n  //\n  // |0|     = NEUTRAL:  Stalemate. No change in state.\n  // |1-4|   = MINOR:    Success with Cost / Glancing Hit.  |  Failure with Hope / Minor Setback.\n  // |5-7|   = MODERATE: Clean Success / Solid Hit.         |  Clear Failure / Significant Setback.\n  // |8+|    = CRITICAL: Decisive Win. Maximum Impact.      |  Catastrophic Loss. Disaster.\n  //\n  // Return: Tier, Direction\n}\n\n// --- 4. SOCIAL INTEGRATION ---\nconst SOCIAL_INTEGRATION = {\n  Rule: \"Dice determine MECHANICAL delivery only. NOT RECEPTION\",\n  Flow: \"Roll CHA -> Get Tier -> Pass Tier to Relationship Audit.\",\n  Locks: \"If Relationship Lock is active (Terror/Hate), even a CRITICAL SUCCESS results in a 'Polite Rejection' (Best possible negative outcome).\"\n}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":10,"characterFilter":{"isExclude":false,"names":[],"tags":[]}},"13":{"uid":13,"key":["executeEventLogic(Context)"],"keysecondary":[],"comment":"EVENT ENGINE","content":"// =============================================================================\n// ||                       EVENT ENGINE (CHAOS MODULE)                       ||\n// =============================================================================\n// CALL ACTION: executeEventLogic(locationContext)\n\n// --- 1. THE ODDS (TRIGGER) ---\nconst EVENT_RULES = {\n  // WE INJECT THE MACROS HERE SO THE VALUES ARE FIXED FOR THIS TURN\n  activation_val: {{roll 20}},\n  outcome_val:    {{roll 20}},\n  isolation_val:  {{roll 20}},\n  \n  // 20% Chance of interruption.\n  threshold: {\n    PASSIVE: \"If activation_val is 1-16 -> No Event. Continue narrative flow.\",\n    ACTIVE:  \"If activation_val is 17-20 -> EVENT TRIGGERED. Proceed to Outcome Scale.\"\n  }\n}\n\n// --- 2. THE SCALES (TYPE) ---\n// Only accessed if EVENT_RULES.activation_val >= 17.\nconst OUTCOME_SCALE = {\n  HOSTILE: {\n    range: \"1-5\",\n    tone: \"Catastrophic to Minor Annoyance.\",\n    examples: \"Ambush, Injury, Theft, Equipment Failure, Hostile Weather.\"\n  },\n  COMPLICATION: {\n    range: \"6-14\",\n    tone: \"Neutral shift. Delays or Misunderstandings.\",\n    examples: \"Sudden crowd, bizarre distinct observation, weather shift, harmless stranger.\"\n  },\n  BENEFICIAL: {\n    range: \"15-20\",\n    tone: \"Positive. Lucky break or Miracle.\",\n    examples: \"Found item, helpful NPC, enemy mistake, clarity.\"\n  }\n}\n\n// --- 3. THE INJECTION (SPAWNING) ---\n// Rule: Context dictates the _nature_ of the event.\nconst INJECTION_PROTOCOL = {\n  PUBLIC: {\n    logic: \"High probability of Entity presence.\",\n    mandate: \"MUST spawn a new or recurring NPC with unique name/dialogue.\"\n},\nISOLATED: {\n    logic: \"Low probability of Entity presence.\",\n    mandate: \"Default: Environmental/Sensory (Sound/Smell/Hazards/Weather).\",\n    exception: \"IF isolation_val >= 17 â†’ Entity encounter. OTHERWISE â†’ Environmental only.\"\n  }\n}\n\n// --- 4. EXECUTION (FUNCTION) ---\nfunction executeEventLogic(locationContext) {\n  // 1. READ INJECTED VALUE: EVENT_RULES.activation_val\n  // 2. CHECK: Is activation_val <= 16? \n  //    -> Return NULL (No Event).\n  \n  // 3. IF (activation_val >= 17) -> TRIGGER ACTIVE.\n  //    a. READ INJECTED VALUE: EVENT_RULES.outcome_val\n  //    b. Map outcome_val to OUTCOME_SCALE (Hostile/Comp/Beneficial).\n  //    c. Check locationContext (Public vs Isolated).\n  // 4. GENERATE PROMPT INJECTION:\n  //    \"Suddenly, [Event Description] interrupts the scene...\"\n  \n  return { triggered: true, val: EVENT_RULES.outcome_val, detail: [Contextual_Event] };\n}","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":13},"15":{"uid":15,"key":["generateName(context)"],"keysecondary":[],"comment":"NAME GENERATION ENGINE","content":"// =============================================================================\n// ||                      NAME GENERATION ENGINE                             ||\n// =============================================================================\n\n// --- 1. FUNCTION ---\nfunction generateName(context) {\n  // 1. Generate 3-letter seed: vowel + any + any\n  // 2. Name MUST start with unchanged seed\n  // 3. Add only pronounceable letters after seed\n  // 4. No 3+ consecutive vowels or consonants\n  // 5. Seed is sacredâ€”never modify, reorder, or remove\n  // Return: Name\n}\n\n// --- 2. PHONETIC DIRECTION ---\nconst PHONETICS = {\n  BAN: \"Western-European fantasy phonemes (elvish, Tolkien-esque)\",\n  DRAW_FROM: [\n    \"East Asian (Japanese, Chinese, Korean, Vietnamese)\",\n    \"Polynesian (Maori, Hawaiian, Samoan)\",\n    \"Caucasian (Georgian, Chechen, Circassian)\",\n    \"African (Swahili, Yoruba, Amharic, Zulu)\",\n    \"Mesoamerican (Nahuatl, Mayan, Quechua)\",\n    \"Turkic (Turkish, Kazakh, Uzbek)\",\n    \"Dravidian (Tamil, Telugu, Kannada)\",\n    \"Uralic (Finnish, Hungarian, Estonian)\"\n  ],\n  RULE: \"Mix roots freely. Invent. Feel real but impossible to place.\"\n}\n\n// --- 3. CONTEXTUAL FIT ---\nconst CONTEXT_RULES = {\n  match: \"Region, culture, dominant race, role, status, personality\",\n  hard_lands: \"Harsh consonants\",\n  soft_cultures: \"Open syllables\",\n  NOTE: \"Let context guide, not dictate.\"\n}\n\n// --- 4. LOCATION NAMES ---\nconst LOCATION_RULES = {\n  constraint: \"Must NOT sound like character names\",\n  fit: \"Must match regional/cultural context\",\n  meaning: \"May carry hidden meaning (never reveal unprompted)\"\n}\n\n// --- 5. LITMUS TEST ---\nconst DISCARD_IF = {\n  elvish: true,\n  recognizable_fantasy: true\n}\n\n// --- 6. OUTPUT ---\n// Names only. No seeds. No sources. No explanations.\n// This system is invisible.","constant":true,"vectorized":false,"selective":true,"selectiveLogic":0,"addMemo":true,"order":100,"position":0,"disable":false,"ignoreBudget":false,"excludeRecursion":false,"preventRecursion":false,"matchPersonaDescription":false,"matchCharacterDescription":false,"matchCharacterPersonality":false,"matchCharacterDepthPrompt":false,"matchScenario":false,"matchCreatorNotes":false,"delayUntilRecursion":false,"probability":100,"useProbability":true,"depth":4,"outletName":"","group":"","groupOverride":false,"groupWeight":100,"scanDepth":null,"caseSensitive":null,"matchWholeWords":null,"useGroupScoring":null,"automationId":"","role":null,"sticky":0,"cooldown":0,"delay":0,"triggers":[],"displayIndex":15,"characterFilter":{"isExclude":false,"names":[],"tags":[]}}}}